<?php

declare(strict_types=1);

namespace Vewe\Utility\Installer;

use Tempest\Console\Console;
use Tempest\Console\ConsoleCommand;
use Tempest\Console\Input\ConsoleArgumentBag;
use Tempest\Container\Container;
use Tempest\Core\Installer;
use Tempest\Core\PublishesFiles;

use function Tempest\src_path;

final class UnpolyInstaller implements Installer
{
    use PublishesFiles;

    private(set) string $name = 'unpoly';

    public function __construct(
        private readonly Container $container,
        private readonly Console $console,
        private readonly ConsoleArgumentBag $consoleArgumentBag,
    ) {}

    public function install(): void
    {
        $getJs = 'https://cdn.jsdelivr.net/npm/unpoly@3/unpoly.min.js';
        $getCss = 'https://cdn.jsdelivr.net/npm/unpoly@3/unpoly.min.css';
    }

    private function shouldMigrate(): bool
    {
        $argument = $this->consoleArgumentBag->get('migrate');

        if ($argument === null || ! is_bool($argument->value)) {
            return $this->console->confirm('Do you want to execute migrations?', default: false);
        }

        return (bool) $argument->value;
    }
}
